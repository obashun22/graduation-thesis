## 概要

\# 要は要約を書けばいい

## はじめに

1. 研究背景

   1. 昨今のマルウェア情勢
      1. ランサムウェアの被害増加  
         近年、マルウェアによる被害が増加している。特に、攻撃対象のシステムを暗号化し、復号と引き換えに金銭の支払いを求めてくるランサムウェアと呼ばれるマルウェアの活動が活発化している。ランサムウェアに感染すると、事業停止に陥ったり、機密情報が流出するなどの被害を被る可能性がある。警視庁の公開する「令和４年上半期におけるサイバー空間をめぐる脅威の情勢等について」によると、国内におけるランサムウェアによる被害の報告件数は 2020 年から年々増加しており、2022 年には 2020 年のおよそ 5 倍の 114 件の被害が報告されている*。また、情報処理推進機構（IPA）が公開している「情報セキュリティ 10 大脅威 2022」*では、組織部門において 2021 年に引き続きランサムウェアが脅威の 1 位として位置付けられており、現在のサイバー空間における大きな脅威となっている。
      2. IoT 機器におけるマルウェアの脅威  
         IoT 機器においてもマルウェアの被害は報告されている。IoT とは、実世界のモノをインターネットに接続し、インターネットを介して情報を相互にやり取りできるようにするという概念である。IoT 機器におけるマルウェアの被害の多くは、ボット型マルウェアによるものであり、感染すると DDoS 攻撃の踏み台に利用されるなどの被害が生じる。特に、2016 年頃に大規模な DDoS 攻撃を行ったことで知られるボット Mirai は、そのソースコードが公開されて以降、その亜種が出現し続けており IoT 機器にとって大きな脅威となっている。  
         IoT 機器がマルウェアに感染する原因の多くが、初期パスワードを変更していなかったりシステムの更新を行なっていないことだと考えられる。情報通信研究機構（NICT）では、感染リスクのある機器を調査し利用者への注意喚起を行う取組、NOTICE を通じてマルウェアに対する対策を講じている。
   2. マルウェア研究における研究対象の偏り

      1. OS の偏り  
         現在、既存のマルウェアに関する研究の多くが、Windows を研究対象としており、Linux といったその他の OS を研究対象にしている研究は比較的少ない\*。Windows を研究対象とする研究が多い背景としては、Windows は他の OS に比べて 利用ユーザが多く、それを狙うマルウェアが多く存在することから、積極的に研究が行われているためであると考えられる。近年、IoT 機器を狙ったマルウェアの脅威の拡大に伴い、Linux などの OS を研究対象とする研究も報告されてきているが、Windows を対象とする研究に比べて十分な議論はなされていない。
      2. アーキテクチャの偏り
         既存のマルウェアに関する研究の中で、ARM アーキテクチャ上で動作するマルウェアを研究対象とした研究は少ない。パーソナルコンピュータでは一般的に x86_64 プロセッサが用いられるのに対し、IoT 機器などの多くの組み込み機器では ARM プロセッサが用いられることが一般的である\*。IoT 機器が普及する以前、マルウェアの多くはパーソナルコンピュータを攻撃対象としていたため x86_64 アーキテクチャを対象とした研究が盛んに行われたが、ARM アーキテクチャを対象とした研究が行われるようになったのは IoT 機器を狙うマルウェアが流行してきた比較的最近のことである\*。
         マルウェアの研究において、アーキテクチャは重要な要素である。アーキテクチャが異なれば命令セットが異なるため、既存の解析手法を異なるアーキテクチャに適応できない。例えば、x86_64 アーキテクチャを対象にしたマルウェアの研究で提案された解析手法は、ARM アーキテクチャを対象にしたマルウェアの解析には適応できない。こうした背景から、ARM アーキテクチャを対象としたマルウェアの研究が急務となっている。

2. 研究目的と概要  
   本研究は、ARM プロセッサの IoT 機器を想定した 3 つの実行環境において、マルウェアが与える影響を定量的に評価し、環境ごとの影響を比較することを目的とする。
   はじめに、影響評価を行う上での評価対象と評価指標を定め、評価実験のための環境構築を行なった。続いて、評価対象のうち ラズビアン環境を用いて定量的なマルウェアの影響評価を行った。
   \# 影響を与える対象は実行環境だけに限らず利用者や第三者も対象になりうる。
   本研究の貢献は、\# 貢献必要？

   - ARM アーキテクチャの実環境を想定した実行環境においてマルウェアが与える影響を定量的に示した
   - 環境ごとのマルウェアの影響を比較することで各環境のマルウェアへの耐性について考察を行なった
     \# 比較まで行っていないので言い換える必要あり
     \# 影響評価の”影響”とは、システムへの操作に加えてその結果生じる影響も指す言葉

3. 本論文の構成  
   本論文は、本章を含めて全５章で構成されている。２章では、関連研究として<関連研究>について述べる。３章では、評価を行う上での評価対象と評価指標を提案し、最後に環境構築<内容変わるかも>について述べる。４章では、実験概要、実験結果、考察について述べる。５章では、本研究の結論とまとめ、今後の課題について述べる。

## 関連研究

\# TODO: 関連研究をあらためて調べてみる

1. マルウェアの解析・分類
2. サンドボックス環境の提案

## 提案手法

\# ある程度一般的な手法として提案

1. 概要  
   本章では、ARM プロセッサで動作する IoT 機器を想定した実行環境において、定量的なマルウェアの影響評価を行うための手法と評価実験を行うための環境構築について述べる。評価対象とする実行環境は、ラズビアン環境、コンテナ環境、ユニカーネル環境の 3 つであり、いずれの環境も IoT 機器の機能としてウェブサーバを想定してウェブサーバアプリケーションをインストールする。これらの実行環境上でマルウェアのサンプルを一つずつ実行し、その振る舞いを実行の可否および脅威スコアの観点から評価する。脅威スコアは、マルウェアが与える脅威の程度を定量的に表した値のことである。
   提案した手法を用いて評価実験を行うにあたり、実験環境のひとつであるラズビアン環境について環境構築を行なった。今後、マルウェアの動的解析を行うことを想定してエミュレート型仮想化ソフトである QEMU を用いて環境の構築を行なった。また、マルウェアの実行、及び実行の可否と脅威スコアを自動で算出するプログラムを作成することで、効率的に評価実験が行える環境を構築した。

2. 評価対象
   \# 影響の評価と環境の評価の二つの言い方をしていて言い方が統一できていない感じ。その環境における影響を評価するので一応環境の評価ではあるけど...
   本研究では、ARM プロセッサで動作する IoT 機器を想定した 3 つの実行環境を評価対象とする。いずれも IoT 機器の機能としてウェブサーバを想定し、ウェブサーバアプリケーションをインストールする。ウェブサーバとしての機能を兼ね備えてた IoT 機器としては、一般的な市販ルータなどが挙げられる。また、いずれの環境も ARM プロセッサで動作させることを前提とする。
   評価対象の 1 つ目が、ラズビアン環境である。ラズビアン環境では、使用する OS として RaspberryPiOS を使用する。IoT 機器の多くがその OS として Linux を採用しており、その中でも RaspberryPiOS は多くのシェアを持っている\*。こうした背景から実行環境として RaspberryPiOS を採用した。
   評価対象の 2 つ目がコンテナ環境である。コンテナ環境では、ウェブサーバがコンテナ環境上で動作していることを想定し、コンテナ型仮想化ソフトウェアとして Docker を使用する。また、使用するイメージは、ウェブサーバとしての機能に必要最低限のパッケージを含んだものを使用する。
   評価対象の 3 つ目がユニカーネル環境である。ユニカーネルとは、OS の一種であり、特定のアプリケーションの実行に必要な最低限のライブラリや機能を搭載した軽量 OS のことである。ユニカーネル環境では、ウェブサーバがユニカーネル上で動作していることを想定する。
   以上の異なる 3 つの実行環境を評価し、比較することにより、実行環境の差異がマルウェアの与える影響にどのような変化をもたらすのか、何が変化をもたらすのかを検討することができる。
3. 評価指標

   - 影響を定量的に評価する上で 2 つの指標を設定する。1 つが、"マルウェアの実行の可否"である。マルウェアの実行の可否は、マルウェアが実行されたかどうかを測る指標である。もう 1 つが脅威スコアである。脅威スコアはそのマルウェアが実行環境やサービス、ユーザなどにどの程度脅威を与えたかを測る指標である。以降、各指標について詳しく述べる。

   1. マルウェアの実行の可否  
      マルウェアの影響を評価する上で重要な視点として、マルウェアのプログラムが正常に動作したかという点が挙げられる。マルウェアがプログラムの実行に失敗した場合、そのマルウェアがもたらす脅威は限定的、あるいは無いものと考えられる。また、プログラムが正常に動作するには適切なライブラリや権限、環境変数、その他条件が揃う必要があることから、マルウェアのプログラムが実行に成功するかどうかは実行環境に大きく依存すると考えられ、環境ごとの影響の差異を比較する上でも重要な項目となる。そこで、本研究では"マルウェアの実行の可否"を評価指標として設定する。
      \# 環境の特性がよく現れる指標であるため環境の比較する上で有効な項目であるということ
      マルウェアの実行の可否では、各マルウェアを実行可能、もしくは実行不可の 2 種類に分類する。分類を行う際のフローチャートを図 < N > に示す。まず、マルウェアを実行し、そもそも実行ができないプログラムについては実行不可として分類する。実行できたもののうち、異常終了したものについては実行不可として分類する。正常終了したものについては実行可能とし、一定時間処理が継続しているものについてもプログラムが正常に動作しているとみなして実行可能と分類する。
      <フローチャートの図>
      \# ウイルスが発症する度合い
      \# 対象のマルウェアが実行ファイルであることを大前提にしてたけど提案手法の段階で前提として述べておく？

   2. 脅威スコア  
      本研究では、実行したマルウェアがもたらす脅威の程度を"脅威スコア"として定量化する。まず、...？
      <脅威スコアの出し方を示す>
      尚、本来であればマルウェアの脅威の程度を計測する場合、システムコール呼び出しやパケットの監視などを行い、実際にどのような脅威が発生したかを観測した上で脅威の程度を定量化するのが自然である。しかしながら、本研究では著者の技術不足のためマルウェアの実際の振る舞いについては観測せず、マルウェアの分類に従った希望的観測による脅威の定量化を行った。
      実行できた場合はマルウェアの分類に応じた相応の影響があると考えられその脅威の大きさを測る指標として採用  
      <こちらもフローチャート的なものがあった方がいいかも>
      \# ウイルスがどの程度重症化するか

4. 環境構築  
   \# CHECK: 自動化の話をすればいい？これって評価環境に含まれない？
   - 将来のシステムコール解析を見据えて QEMU による仮想環境上で評価を行う
   - 自動化の方法 # 環境構築かと言われると微妙だが評価環境か実験概要？に含まれてもおかしくない
   - 具体は実験概要に記述するのでより一般な記述とすることを心がける
   - 出来るだけ抽象的に一般的な内容を記述
   - Ubuntu
   - QEMU
   - VirusShare を"Web 上のリポジトリ"とするような感じで

## 評価

\# 実際に行った具体的な事象について記述

1. 実験概要
   - 実験環境の詳細
     - 使用 PC やバージョン等
     - 使用サンプル
   - 実験条件
2. 実験結果
   - 実験結果の事実のみを示す
   - 実行の可否や脅威スコア以外にもどのくらい掛かったかなど？
   - ほとんどがセグフォだったとかの予備情報も加えて
3. 考察
   - 実行に失敗したマルウェアの原因と考えられるもの # より詳細に解析するのもひとつ／これはあくまでサブ的な考察
   - 他の環境との比較  
     \# 影響の評価ができていない？脅威スコアを計測するという意味ではできているけど…

## おわりに

1. 結論とまとめ
   - IoT 機器を想定した実行環境においてマルウェアの影響を評価する手法を提案し、実際に実験を行い計測を行った
   - マルウェアの実行に失敗した原因について考察した
2. 今後の課題
   - 今回はマルウェアの影響をその分類から予測してそのマルウェアが与える影響を評価したが、今後はより詳細に実行したシステムコールやファイル操作、ポートの開閉などを観測しその挙動を定量的に示したい
   - 脅威スコアは実行の可否から算出したが、より緻密に計測するために先に述べたシステムコールの操作などを元に CVEE？などの観点から定量的評価を行っていきたい

## 参考文献
